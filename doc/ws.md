# Описание WS взаимодействия

Здесь описываётся методы взаимодействия между websocket: сообщения от сервера и правильные сообщения от клиента

URL для WS: `wss://kontur.yakovlev05.ru/ws/game`

Для подключения к WS, нужно создать игру, в ответ на создание игры придёт id игры. В итоге url подключения будет
выглядеть так:
`wss://kontur.yakovlev05.ru/ws/game?gameId=8fc18dda-cecd-4832-ae33-062eecfd16e0` (пример)

## Сообщения от клиента к серверу

Типы сообщений:

- CLICK
- ANSWER

### 1. CLICK

```
{
  "type": "CLICK"
}
```

**Описание:** Посылается при клике пользователя. Первый клик **запускает** таймер и начинает игру.

### 2. ANSWER

```
{
  "type": "ANSWER",
  "answerId": 1
}
```

**Описание:** Ответ на вопрос. Отправляется, когда приходит вопрос.

**Поля:**

- `answerId` - Id ответа

## Сообщения от сервера к клиенту

Типы сообщений:

- SPEED
- QUESTION
- ANSWER_RESULT
- TIME_UP
- RESULT
- EXPIRE_ANSWER

### 1. SPEED

```
{
  "type": "SPEED",
  "speed": 1,
  "myHp": 100,
  "hrHp": 99
}
```

**Описание:** информация о скорости

**Поля:**

- `speed` - скорость, величину измерения можно задать в настройках игры
- `myHp` - хп человека на собеседовании
- `hrHp` - хп HR, принимающего собеседование

### 2. QUESTION

```
{
  "type": "QUESTION",
  "text": "Как правильно поднять compose файл в docker?",
  "questionId": 4,
  "answers": [
    {
      "id": 13,
      "text": "docker run"
    },
    {
      "id": 14,
      "text": "docker compose up"
    },
    {
      "id": 15,
      "text": "docker start"
    },
    {
      "id": 16,
      "text": "docker compose start"
    }
  ],
  "secondsLeft": 4,
  "myHp": 100,
  "hrHp": 85
}
```

**Описание:** Вопрос, на который нужно ответить. У вопроса один верный ответ. Системой количество ответов не ограничено,
но мы договорились о 4.

**Поля:**

- `text` - текст вопроса
- `questionId` - id вопроса
- `answers_id` - id ответа
- `aswers_text` - текст ответа
- `myHp` - хп человека на собеседовании
- `hrHp` - хп HR, принимающего собеседование

### 3. ANSWER_RESULT

```
{
  "type": "ANSWER_RESULT",
  "yourAnswerId": 1,
  "correctAnswerId": 1,
  "myHp": 100,
  "hrHp": 56,
  "correct": true
}
```

**Описание:** Результат проверки ответа

**Поля:**

- `yourAnswerId` - id ответа, который выбрал пользователь
- `correctAnswerId` - id правильного ответа
- `correct` - правильно ли ответил пользователь (по сути излишне)
- `myHp` - хп человека на собеседовании
- `hrHp` - хп HR, принимающего собеседование

### 4. TIME_UP

```
{
  "type": "TIME_UP",
  "myHp": 100,
  "hrHp": 99,
  "win": false
}
```

**Описание:** ответ, когда время игры вышло. После следует разрыв соединения.

**Поля:**:

- `win` - выиграли ли? нет
- `myHp` - хп человека на собеседовании
- `hrHp` - хп HR, принимающего собеседование

### 5. RESULT

```
{
  "type": "RESULT",
  "score": 7777,
  "username": "strisancxcg12z",
  "myHp": 100,
  "hrHp": 0,
  "win": true
}
```

**Описание:** ответ при выигрыше. Результат заносится в таблицу рекордов. Здоровье HR ниже или равно 0. За сообщением
следует разрыв соединения

**Поля:**

- `score` - количество очков
- `username` - имя пользователя
- `win` - выиграл ли? да
- `myHp` - хп человека на собеседовании
- `hrHp` - хп HR, принимающего собеседование

### 6. EXPIRE_ANSWER

```
{
  "type": "EXPIRE_ANSWER",
  "myHp": 50,
  "hrHp": 83
}
```

**Описание:** ответ при истечении срока ответа на вопрос

**Поля:**

- `myHp` - хп человека на собеседовании
- `hrHp` - хп HR, принимающего собеседование
